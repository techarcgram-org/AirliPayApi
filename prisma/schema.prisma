generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model accounts {
  id                         BigInt                @id @default(autoincrement())
  email                      String                @unique(map: "index_accounts_on_email") @default("") @db.VarChar
  encrypted_password         String                @default("") @db.VarChar
  username                   String?               @db.VarChar
  reset_password_token       String?               @unique(map: "index_accounts_on_reset_password_token") @db.VarChar
  reset_password_sent_at     DateTime?             @db.Timestamp(6)
  remember_created_at        DateTime?             @db.Timestamp(6)
  sign_in_count              Int                   @default(0)
  current_sign_in_at         DateTime?             @db.Timestamp(6)
  last_sign_in_at            DateTime?             @db.Timestamp(6)
  current_sign_in_ip         String?               @db.VarChar
  last_sign_in_ip            String?               @db.VarChar
  confirm_secret             String?               @db.VarChar
  email_confirmed            Boolean?
  email_confirmation_sent_at DateTime?             @db.Timestamp(6)
  phone_confirmed            Boolean?
  phone_confirmation_sent_at DateTime?             @db.Timestamp(6)
  account_status             account_status_types? @default(PENDING)
  activation_date            DateTime?             @db.Date
  access_token               String?               @db.VarChar
  refresh_token              String?               @db.VarChar
  failed_attempts            Int                   @default(0)
  unlock_token               String?               @db.VarChar
  locked_at                  DateTime?             @db.Timestamp(6)
  account_type               account_types
  created_at                 DateTime              @db.Timestamp(6)
  updated_at                 DateTime              @db.Timestamp(6)
  admins                     admins[]
  clients                    clients[]
  users                      users[]
}

model addresses {
  id                     BigInt    @id @default(autoincrement())
  primary_phone_number   String?   @db.VarChar
  city                   String?   @db.VarChar
  region                 String?   @db.VarChar
  street                 String?   @db.VarChar
  secondery_phone_number String?   @db.VarChar
  created_at             DateTime  @db.Timestamp(6)
  updated_at             DateTime  @db.Timestamp(6)
  admins                 admins[]
  banks                  banks[]
  clients                clients[]
  users                  users[]
}

model admins {
  id         BigInt    @id @default(autoincrement())
  name       String?   @db.VarChar
  role       Int?
  account_id BigInt
  address_id BigInt
  created_at DateTime  @db.Timestamp(6)
  updated_at DateTime  @db.Timestamp(6)
  accounts   accounts  @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_14a59fabad")
  addresses  addresses @relation(fields: [address_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_c8120b7a66")

  @@index([account_id], map: "index_admins_on_account_id")
  @@index([address_id], map: "index_admins_on_address_id")
}

model ar_internal_metadata {
  key        String   @id @db.VarChar
  value      String?  @db.VarChar
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)
}

model client_payments {
  id         BigInt   @id @default(autoincrement())
  status     Int?
  client_id  BigInt
  amount     Decimal? @db.Decimal
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)
  clients    clients  @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_e4adce2942")

  @@index([client_id], map: "index_client_payments_on_client_id")
}

model clients {
  id                    BigInt            @id @default(autoincrement())
  name                  String?           @db.VarChar
  industry              Int?
  tax_id                String?           @db.VarChar
  client_commision      Int?
  earning_report_status Boolean?
  next_payment_date     DateTime?         @db.Date
  employee_roaster_file String?           @db.VarChar
  account_id            BigInt
  address_id            BigInt
  created_at            DateTime          @db.Timestamp(6)
  updated_at            DateTime          @db.Timestamp(6)
  client_payments       client_payments[]
  addresses             addresses         @relation(fields: [address_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_56e36fce15")
  accounts              accounts          @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_bed59fd791")
  users                 users[]

  @@index([account_id], map: "index_clients_on_account_id")
  @@index([address_id], map: "index_clients_on_address_id")
}

model schema_migrations {
  version String @id @db.VarChar
}

model users {
  id                         BigInt                       @id @default(autoincrement())
  name                       String?                      @db.VarChar
  base_salary                Decimal?                     @db.Decimal
  employee_id                String?                      @db.VarChar
  dob                        DateTime?                    @db.Date
  sex                        String?                      @db.VarChar
  photo                      String?                      @db.VarChar
  next_payment_date          DateTime?                    @db.Date
  received_earlypay          Boolean?
  client_id                  BigInt
  address_id                 BigInt
  account_id                 BigInt
  created_at                 DateTime                     @db.Timestamp(6)
  updated_at                 DateTime                     @db.Timestamp(6)
  account_settings           account_settings[]
  airlipay_balances          airlipay_balances[]
  early_transactions         early_transactions[]
  savings_balances           savings_balances[]
  savings_transactions       savings_transactions[]
  user_banks                 user_banks[]
  user_mobile_money_accounts user_mobile_money_accounts[]
  accounts                   accounts                     @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_61ac11da2b")
  clients                    clients                      @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_d3559eaf4c")
  addresses                  addresses                    @relation(fields: [address_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_eb2fc738e4")

  @@index([account_id], map: "index_users_on_account_id")
  @@index([client_id], map: "index_users_on_client_id")
  @@index([address_id], map: "index_users_on_address_id")
}

model banks {
  id           BigInt       @id @default(autoincrement())
  name         String?      @db.VarChar
  is_partner   Boolean?
  supports_api Boolean?
  swift        String?      @db.VarChar
  address_id   BigInt
  created_at   DateTime     @db.Timestamp(6)
  updated_at   DateTime     @db.Timestamp(6)
  addresses    addresses    @relation(fields: [address_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_310a58ada9")
  user_banks   user_banks[]

  @@index([address_id], map: "index_banks_on_address_id")
}

model user_banks {
  id               BigInt             @id @default(autoincrement())
  account_number   String?            @db.VarChar
  user_id          BigInt
  bank_id          BigInt
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  account_settings account_settings[]
  banks            banks              @relation(fields: [bank_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_8489a27145")
  users            users              @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_9e84f48ddd")

  @@index([bank_id], map: "index_user_banks_on_bank_id")
  @@index([user_id], map: "index_user_banks_on_user_id")
}

model account_settings {
  id                         BigInt                      @id @default(autoincrement())
  language                   String?                     @db.VarChar
  security_pin               String?                     @db.VarChar
  notification_enabled       Boolean?
  pin_enabled                Boolean?
  two_fa_enabled             Boolean?
  default_bank_id            BigInt?
  default_momo_account_id    BigInt?
  user_id                    BigInt
  created_at                 DateTime                    @db.Timestamp(6)
  updated_at                 DateTime                    @db.Timestamp(6)
  user_banks                 user_banks?                 @relation(fields: [default_bank_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_68404ac0af")
  user_mobile_money_accounts user_mobile_money_accounts? @relation(fields: [default_momo_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_9a762b5dd2")
  users                      users                       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_e382d4202a")

  @@index([default_bank_id], map: "index_account_settings_on_default_bank_id")
  @@index([user_id], map: "index_account_settings_on_user_id")
  @@index([default_momo_account_id], map: "index_account_settings_on_default_momo_account_id")
}

model user_mobile_money_accounts {
  id               BigInt             @id @default(autoincrement())
  phone_number     String?            @db.VarChar
  operator         operators?
  user_id          BigInt
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  default          Boolean?
  account_settings account_settings[]
  users            users              @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_f3b530b4f3")

  @@index([user_id], map: "index_user_mobile_money_accounts_on_user_id")
}

model airlipay_balances {
  id                   BigInt              @id @default(autoincrement())
  user_id              BigInt
  balance              Float?
  early_transaction_id BigInt?
  created_at           DateTime            @db.Timestamp(6)
  updated_at           DateTime            @db.Timestamp(6)
  early_transactions   early_transactions? @relation(fields: [early_transaction_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_67ce807e38")
  users                users               @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_af9cfa2627")

  @@index([user_id], map: "index_airlipay_balances_on_user_id")
  @@index([early_transaction_id], map: "index_airlipay_balances_on_early_transaction_id")
}

model savings_balances {
  id                     BigInt                @id @default(autoincrement())
  user_id                BigInt
  balance                Float?
  savings_transaction_id BigInt?
  created_at             DateTime              @db.Timestamp(6)
  updated_at             DateTime              @db.Timestamp(6)
  savings_transactions   savings_transactions? @relation(fields: [savings_transaction_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_03bca7691a")
  users                  users                 @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_acccd5babc")

  @@index([savings_transaction_id], map: "index_savings_balances_on_savings_transaction_id")
  @@index([user_id], map: "index_savings_balances_on_user_id")
}

model savings_transactions {
  id               BigInt             @id @default(autoincrement())
  user_id          BigInt
  status           withdrawal_status?
  transaction_type transaction_types? @default(WITHDRAW)
  initiated_date   DateTime?          @db.Timestamp(6)
  execution_date   DateTime?          @db.Timestamp(6)
  amount           Float?
  fees             Float?
  new_balance      Float?
  old_balance      Float?
  operator         operators?
  phone_number     String?            @db.VarChar
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  savings_balances savings_balances[]
  users            users              @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_6b026816cc")

  @@index([user_id], map: "index_savings_transactions_on_user_id")
}

model early_transactions {
  id                BigInt              @id @default(autoincrement())
  user_id           BigInt
  status            withdrawal_status?
  transaction_type  transaction_types?  @default(WITHDRAW)
  initiated_date    DateTime?           @db.Timestamp(6)
  execution_date    DateTime?           @db.Timestamp(6)
  amount            Float?
  fees              Float?
  new_balance       Float?
  old_balance       Float?
  operator          operators?
  phone_number      String?             @db.VarChar
  created_at        DateTime            @db.Timestamp(6)
  updated_at        DateTime            @db.Timestamp(6)
  airlipay_balances airlipay_balances[]
  users             users               @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_08c702b977")

  @@index([user_id], map: "index_early_transactions_on_user_id")
}

enum transaction_types {
  WITHDRAW
  DEPOSIT
}

enum withdrawal_status {
  SUCCESS
  PENDING
  FAILED
}

enum operators {
  ORANGE
  MTN
  UNKNOWN
}

enum account_status_types {
  DEACTIVATED
  ACTIVE
  PENDING
  BLOCKED
  BANNED
}

enum account_types {
  ADMIN
  CLIENT
  USER
}
